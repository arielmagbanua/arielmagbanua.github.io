$(document).ready(function(){
    // initializations
    $('.sidenav').sidenav();
    var url = window.location.href;
    var id = url.substring(url.lastIndexOf('#') + 1);

    var item = $('#'+id);
    item.show().siblings("div").hide();
    // restore active item selected
    $('ul.sidenav li').removeClass('bold active');
    $('#id-'+id).addClass('bold active');

    $('a.nav-link').click(function(){
        var target = $(this).attr('href');
        console.log(target);
        $(target).show().siblings("div").hide();

        // remove all active status and turn the currently selected item as active
        $('ul.sidenav li').removeClass('bold active');
        $(this).closest("li").addClass('bold active');
    });

    $('#compare-button').click(function(){
        diffUsingJS();
        $('th.author').hide();
    });
});

function diffUsingJS(viewType) {
    "use strict";
    var byId = function (id) { return document.getElementById(id); },
        base = difflib.stringAsLines(byId("base-text-container").value),
        newtxt = difflib.stringAsLines(byId("new-text-container").value),
        sm = new difflib.SequenceMatcher(base, newtxt),
        opcodes = sm.get_opcodes(),
        diffoutputdiv = byId("diffoutput");
        //contextSize = byId("contextSize").value;

    diffoutputdiv.innerHTML = "";
    // contextSize = contextSize || null;

    diffoutputdiv.appendChild(diffview.buildView({
        baseTextLines: base,
        newTextLines: newtxt,
        opcodes: opcodes,
        baseTextName: "Base Text",
        newTextName: "New Text",
        // contextSize: contextSize,
        viewType: viewType
    }));
}